version: 2
jobs:
 build:
  docker:
   - image: circleci/python:3.8.1
  steps:
   - checkout
   - restore_cache:
      key: deps-{{ checksum "poetry.lock" }}
   - run:
      command: |
        poetry config virtualenvs.path /home/circleci/project/
        poetry install
   - save_cache:
      key: deps-{{ checksum "poetry.lock" }}
      paths: 
       - .
   - run:
      command: |
        poetry run python3 -m unittest -v